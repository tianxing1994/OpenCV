### [基于图的视觉显著性](https://papers.nips.cc/paper/3095-graph-based-visual-saliency.pdf)
Jonathan Harel, Christof Koch , Pietro Perona  
帕萨迪纳, CA 91125  
{harel, koch} @ klab.caltech.edu, perona@vision.caltech.edu

#### 摘要
提出了一种新的自下面上的视觉显著性模型, 即基于图的视觉显著性 (GBVS).
它包括两个步骤: 首先在某些特征通道上形成激活图, 然后以突出显著性且允许与其他图相结合的方式对其进行规范化.
该模型很简单, 并且在自然并行化的范车内具有生物学上的合理性. 该模型可以在 108 个自然图像的 749 个变体上有力地预测人类活动,
达到基于人类控制的 ROC 面积的 98%, 而经典算法 Itti & Koch 仅达到 84%.

#### 1. 介绍
包括人类在内的大多数脊椎动物都可以移动他们的眼睛. 他们使用这种能力从场景中提取最相关的详细采样,
同时只在其他地方花费有限的处理资源. 视觉社区一直很感兴趣在给定图像(或视频)的情况下预测人们在固定时间自由观看场景时注意的地方.
除了了解人类和动物的这种非凡能力的纯粹科学目标之外, 始终如一地专注于 "重要" 信息, 存在巨大的工程应于, 如: 图像压缩和识别.
标准方法是基于生物学动机的特征选择, 然后进行高亮显示局部梯度的中心环绕操作, 最后通过组合步骤产生 "主图".
最近, Bruce 和其它研究者假设, "自信息" 和 "奇异信息" 的基本数量是显著性或注意力的核心.
但是, 最终 Bruce 计算出了一个在特征图中可加的函数, 其主要贡献是作为一种在特征图中进行操作以获取激活或显著图的方法.
Itti 和 Baldi 定义了一般的 "surprise (奇异信息)", 但最终为了从各个特征通道中得到经典意义上的显著图,
然后使用另一个可以突出局部变化的函数在这些特征图上进行操作.
通过组织这些不同方法的拓扑, 我们可以更严格地比较它们: 即, 不仅仅是端到端, 而是分段的,
从而消除了有关观察到的性能差异来源的某些不确定性.

因此, 视觉显著性的领先模型可以分为以下三个阶段.
1. (s1)提取: 在图像平面上方的位置提取特征向量.
2. (s2)激活: 使用特征向量形成一个或多个 "激活图".
3. (s3)规范化/组合: 规范化激活图 (然后对激活图进行组合).
因此, [5] 是对步骤 2 的贡献, 而 [4] 是对步骤 3 的贡献. 在经典算法中,
步骤 1 使用受生物学启发的滤波器完成, 步骤 2 通过减去不同尺度的特征图得到 (此后称 "c-s" 为中心外围),
而步骤 3 通过三种方式之一完成:
```angular2html
1. 基于局部最大值的归一化方案 ("max-ave").
2. 一个基于高斯差分滤波器 ("DoG") 的卷积迭代方案.
3. 一种非线性作用方法 ("NL"), 该方法以模拟心理物理学的方式将局部特征值除以周围值的加权平均值.
```

```angular2html
批注: 步骤 1, 也许可以将图像转换到 Lab 色彩空间, 
每一个 Lab 空间的一个通道可作为一个特征图 M. 
```

我们采用一种不同的方法, 利用图算法的计算能力, 地形结构和并行性质来实现有效的显著性计算.
我们在各图像地图上定义马尔可夫链, 并将图上各位置上的平衡分布视为激活值和显著性值. 这个想法并不完全是新的:
Brockmann 和 Geisel 提取, 可以通过正确定义 Levy 对显著性区域的作用来预测扫描路径, 而最近 Boccignone 和 Ferraro 也这样做.
重要的是, 他们假设显著图已经可用, 并且提供了一种将所有对象映射到一组固定位置的 "赢家通吃" 方法的替代方法.
L.F.Costa 在未出版的预印本中指出了类似的想法, 但是仅提供了有关如何钭其应用于真实图像的粗略细节, 实际上, 没有涉及注视机制的实验.
在此, 我们对显著度计算的 2 和 3 步骤采用统一的方法: 使用相异性和显著性来定义图上的权重, 这些图被解释为马尔可夫链.

与先前的作者不同, 我们不只将在某种程度上相似的特征要素相连接, 我们将预测人类注意力机制作为度量, 直接与其他的方法进行比较.

本文本贡献如下:
1. 基于图计算的完整的自下而上的显著性模型, GBVS, 包括一个 "激活" 和 "规范化/组合" 框架.
2. Einhäuser 等人最近的一项研究将 GBVS 与自然环境 (即 foliage) 灰度图像数据集上的现有基准进行了比较,
并与 7 位人类受试者的眼动注视数据进行了比较. 等.

#### 2. 此方法: 基于图的显著性检测 (GBVS)
给定一张图片 I, 我们希望根据某种标准, 最终突出显示出一些 "有意义的" 位置, 图片的这些位置具有 "信息丰富". 如人的注意力机制.
如前所述, 该过程以第一计算特征图(s1)为条件, 例如: 在线性滤波后再加上一些基本的非线性操作. "激活(s2)", "规范化/组合(s3)" 步骤如下所述.

##### 2.1 形成激活图(s2)
假设我们给定一个特征图 M: [n]^{2} → R. 我们的目标是要计算出一个激活图 A: [n]^{2} → R,
如此, 直觉上地, 我们会认为图像 I 中的 (i, j) 位置或其代理图 M 的 M(i, j) 值如果在某种程度上与其周围的像素显得 "不寻常",
则该位置将在激活图 A 中对应一个比较大的值.

###### 2.1.1 现存方案
当然, "不寻常" 不能充分约束我们, 因此可以选择几种操作定义. "不可能发生" 将得出 Bruce 的表述,
其中在 (i, j) 周围的某个区域中计算 M(i, j) 值的直方图. 随后将其归一化并视为概率分布,
因此 A(i, j) = -log(p(i, j)) 很显然可通过 p(i, j) = PrfM(i, j|neighborhood) 来定义.
另一种方法将局部 "中心" 分布与更广泛的区域进行比较, 并根据这两个 "surprise (奇异信息)" 调用 Kullback-Leibler 张力.

```angular2html
批注: 对比当前像素的邻近像素, 求当前像素的出现概率的负对数作为显著值. 
```

###### 2.1.2 马尔可夫方法
我们提出了另一种方法 (见下文). 让我们定义 M(i, j) 和 M(p, q) 的不相似性为: 
abs(log(M(i, j) / M(p, q)))  
![dissimilarity](http://chart.googleapis.com/chart?cht=tx&chl=\Large%20d((i,%20j)%20||%20(p,%20q))%20=%20|log\frac{M(i,%20j)}{M(p,%20q)}|)

这是自然的差异定义: 两个量之比之间的距离的对数 (以对数刻度测量). 
对于我们的某些实验, 我们改用 |M(i, j) - M(p, q)| 来代替, 且, 我们发现这个也能很好地工作. 
现在考虑完全连通的有向图 G_{a}, 现在考虑通过连接晶格 M 的每个节点而获得的完全连接的有向图 G_{a}, 
其标记为采用属于 [n]^{2} 的索引, 当前节点与其它的 n-1 个节点连接. 
从节点 (i, j) 到节点 (p, q) 的有向边将被分配一个权重:   

```angular2html
ω_{1}((i, j), (p, q)) = d((i, j) || (p, q)) · F(i-p, j-q)
  
其中: F(a, b) = exp(-(a^2+b^2) / (2σ^2))
  
批注: 这是一个基于高斯分布的权重分配. 
```

在本算法中, σ 是一个自由参数. 因此, 从 node(i, j) 到 node(p, q) 
边的权重与它们的不相似性以及它们在 M 域中的接近度成正比. 请注意, 在节点间的边的相反的方向他们的权重也具有相同的值. 
现在, 我们可以通过将每个节点的出站边缘的权重标准化为 1 来定义 G_{a} 上的马尔可夫链, 
并画出节点与状态之间的等价关系, 边缘权重与转移概率之间的等价关系. 
该链的平衡分布, 反映随机步行者在永远行走的情况下, 其在各节点/州上花费的时间. 
且会自然地在与其高度不相似的周围节点处积累质量, 因为有可能过渡到此类子图, 
而如果节点间具有相似的 M 值, 则不太可能. 
结果是从成对对比中得出的激活度量.  

```angular2html
批注: 
1. 每个像素根据自己根其它像素的边权重, 向其它像素进行显著度投票, 
越是与当前像素不一样, 越是离当前像素近的像素, 将获得更大的值. 
(让每个像素都拥有 1 票, 像素按自身所有边的权值比例划分给各像素的投票. )
2. 第一轮投票结束后, 各边的权值不变, 但各像素的票数不一样. 
各像素根据自己拥有的票数, 用它来向其它像素投票. 
3. 如此迭代. 
```

我们把这种方法称为 "有机" 方法, 是因为从生物学上讲, 各个 "节点" (神经元) 存在于相连的, 
视网膜组织的网络(视觉皮层)中, 并且以引起紧急行为的方式相互(突触发射)进行通讯, 
并快速决策哪些区域需要额外处理. 

类似地, 我们的方法以一种原则上可以完全并行的方式暴露出不相似区域的连接. 
可以在每个节点上独立进行计算: 在同步环境中, 在每个时间步长, 每个节点只是简单地对输入质量求和, 
然后根据出站边缘权重将该质量的测量分区传递到其邻居. 
在所有节点上同时发生的同一简单过程会导致质量的均衡分布. 

* 技术说明
该链的平衡分布, 存在且唯一, 因为该链是遍历的, 即底层图 G_{a} 是通过紧密的连接构建起来的. 
实际上, 使用马尔可夫矩阵与初始均匀向量的重复乘法来计算平衡分布. 该过程产生矩阵的主要特征向量. 
因此, 计算复杂度为 O(n_4 * K) 其中 K << n^2 是达到平衡所需的少量迭代. 

##### 2.2 "规范化" 激活图 (s3)
该算法的 "标准化" 步骤的目标远不如激活步骤的目标明确. 但是, 这是至关重要的, 而且研究领域很广. 
前面, 提到了三种单独的方法作为现有基准, 并且 Itti 的最新工作在此过程的此阶段也进入了显著性计
算 (尽管如上所述, 它也可以于 s2 步骤). 
我们将这一步骤的目标声明为: 将质量集中在激活图上.
如果质量不在可加组合之前集中在单个激活图上, 则最终的主图可能会过于统一而体现不出足够的信息. 
尽管这看似微不足道, 但在某种程度上, 它是任何显著性算法的精髓: 将激活集中在几个关键位置. 

有了质量浓度定义, 我们提出了另一种马尔可夫算法, 如下所示: 
这次我们从激活图开始 A: [n]^2 → R, 这是我们想要规范化的图. 
用 n^2 个节点构建图 G_{N} 并用来自 [n]^2 的索引标记. 对于每个节点 (i, j) 和每个节
点 (p, q) (包含 (i, j))的连接, 
我们引入从 (i, j) 到 (p, q) 的权重边.  

```angular2html
ω_{2}((i, j), (p, q)) = A(p, q) · F(i-p, j-q)
  
批注: 激活图上的每一个像素按高斯分布向其周围投票. 
```
再一次, 将每个节点的出站边缘的权重归一化为 1 并将结果图视为马尔可夫链, 
这使得我们能够计算出节点上的平衡分布. 

质量将优先流向那些具有高激活率的节点. 它是一种通过构造的质量集中算法, 以及与以前一样可并行化的具有相同的自然优势. 
从实验上看, 与 "DoG" 和 "NL" 之类的标准方法相比, 它的表现似乎非常好. 


#### 3 实验结果



