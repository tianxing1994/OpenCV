## [局部尺度不变特征的目标识别](https://www.cs.ubc.ca/~lowe/papers/iccv99.pdf)
### 摘要
现开发出了一种基于图像局部特征的目标识别系统. 此特征对图像缩放, 平移, 旋转具有不变性. 且对照明变化, 仿射或 3D 投影也有一定的稳定性. 
这些特征与灵长类动物视觉中用于物体识别的的颞下皮质神经元具有相似的属性. 通过对像在不同尺度空间下的, 分阶滤波下的稳定点识别可以有效地检测出此特征. 
通过在多个定向平面, 多个比例的图像上进行模糊后创建出的图像关键点具有局部几何变形不变性.
这些关键点用作匹配物体的邻近搜索算法的输入. 通过寻找残差最小二乘解的最小值, 可以完成对每个匹配项的最终验证. 
实现结果表明, 在杂乱的部分遮挡图像中, 可以以不到 2 秒的计算时间实现鲁棒的目标识别. 


### 1. 介绍
在杂乱的现实场景中进行目标识别, 需要图像的局部特征不受其混乱和部分遮挡的影响. 
这些特征必须对照明, 3D 投影变换和常风对象变化具有至少部分不变性. 
另一方面, 这些特征还必须具有足够的独特性, 以在许多其它的场景中能够标识出特定的对象. 
物体识别问题的困难很大程度上是由于未能成功找到这种图像特征. 
然而, 最近对密集局部特征的研究表明, 通常可以通过使用在大量可重复位置采样的局部图像描述符来实现有效识别. 

文本提出一种新的图像特征生成方法, 尺度不变特征变换(SIFT). 
这种方法将图像转换为大量的局部特征向量, 每个局部特征向量对于图像平移, 缩放和旋转都是不变的, 而且对照明变化和仿射或 3D 投影具有部分不变性. 
此前的局部特征生成方法缺乏尺度不变性, 并且对投影失真和照明变化敏感. SIFT 方法与灵长类动物视力下颞叶 (IT) 皮质中神经元的反应具有许多共同的特性. 
本文还描述了索引和模型验证的改进方法. 

通过使用分层级的滤波方法, 可以有效地识别尺度不变特征. 
第一阶段通过寻找高斯差函数的最大值或最小值的位置来确定尺度空间中的关键位置. 每个点都用于生成特征向量, 
该特征向量描述相对于其比例空间坐标系采样的局部图像区域. 这些特征通过模糊图像的渐变位置来实现如仿射3D投影变换的部分不变性. 
该方法是基于哺乳动物视觉的大脑皮层中复杂细胞行为的模型. 其结果特征向量称作 SIFT 关键点. 
在当前的实现中, 每个图像生成 1000 个 SIFT 关键点, 此过程需要不到 1 秒的计算时间. 

从图像生成的 SIFT 关键点可使用邻近算法实现目标候选模型的索引. 
先通过霍夫变换哈希表识别出与潜在模型相符的字键点集合, 然后通过最小二乘法拟合模型参数的最终估计值. 
当至少存在 3 个关键点在残差较低的模型参数上达成一致时, 则可以证明物体的存在. 
由于典型对象的图像中可能有数十个 SIFT 关键点, 因此即使在图像中具有大量的遮挡, 但仍保持较高的可靠性. 

当前对象模型表示为可以进行仿射投影的 SIFT 关键点的 2D 坐标. 
在特征位置具有相当变换的情况下, 仍然可以进行平面形状的透视识别, 该平面投影距离相机最多旋转 60 度, 或者允许 3D 对象旋转最多 20 度. 


### 2. 相关研究
对象识别在机器视觉行业中广泛用于检查, 注册和操纵的目的. 但是, 当前用于对象识别的商业系统几乎完全依赖于基于相关性的模板匹配.
虽然对于严格控制对象姿态和照明的某些工程环境非常有效, 但是当允许对象旋转, 缩放, 照明和 3D 姿态变化时, 模板匹配在计算上变得不可行, 
而在处理部分可见性和大型模型数据库时, 模板匹配甚至变得不可行. 
一个可替代的方案是仅在图像的局部提取出具有不变性的特征, 并仅对这些特征进行匹配. 
已经提出并探索了许多候选特征类型, 包括线段, 边缘分组和区域, 还有许多其他提议. 
尽管这些功能对于某些对象类别效果很好, 但通常不会足够频繁地检测和足够稳定地检测它们, 从而无法形成可靠识别的基础. 

最近开发了密度更高的图像特征集合. 
一种方法是使用拐角检测器 (更准确地说, 是局部图像变化中的峰值的检测器) 来标识可重复的图像位置, 
围绕该位置可以测量局部图像属性. 使用 Harris 角检测器来识别特征位置, 以对从不同视点拍摄的图像进行极线对准. 
与其尝试使一幅图像的区域与第二幅图像中的所有可能区域相关联, 
不如通过仅匹配以每幅图像中的拐角点为中心的区域来节省大量的计算时间. 

对于物体识别问题, Schmid＆Mohr 也使用 Harris 角检测器来识别兴趣点, 
然后根据高斯导数图像测量的方向不变矢量在每个兴趣点上创建一个局部图像描述符. 
通过寻找满足基于对象的方向和位置约束的多个匹配描述符, 
这些图像描述符被用于鲁棒的对象识别. 
这项工作对于大型数据库中的识别速度以及处理混乱图像的能力都给人留下了深刻的印象. 

这些先前方法中使用的拐角检测器有一个主要缺陷, 那就是它们仅以单一比例检查图像. 
随着比例尺的变化变得明显, 这些检测器会响应不同的图像点. 
另外, 由于检测器没有提供物体比例的指示, 
因此有必要创建图像描述符并尝试以大量比例进行匹配. 
本文介绍了一种有效的方法来确定尺度空间中的稳定关键位置. 
这意味着图像的不同缩放比例不会影响所选的关键位置集. 

此外, 为每个点确定一个显式比例, 
这允许在每个图像中以等效比例对那个点的图像描述矢量进行采样. 
在每个位置确定规范的方向, 以便可以相对于一致的局部 2D 坐标系执行匹配. 
与 Schmid 和 Mohr 使用的旋转不变的图像描述符相比, 这允许使用更独特的图像描述符, 
并且对描述符进行了进一步修改, 以提高其对仿射投影和照明变化的稳定性. 

其他基于外观的识别方法包括本征空间匹配, 颜色直方图和感受野直方图. 
这些方法都已经在孤立的对象或预先分割的图像上成功地进行了演示, 
但是由于它们具有更全局的特征, 很难将它们扩展到混乱和部分遮挡的图像上. 
Ohba＆Ikeuchi 通过使用许多小的局部本征窗口成功地将本征空间方法应用于杂乱的图像, 
但这需要像模板匹配一样, 高昂的计算代价以搜索新图像中的每个窗口. 


### 3. 关键点定位
我们希望确定图像缩放空间中相对于图像平移, 
缩放和旋转不变的位置, 并且这些位置受噪声和小失真的影响最小. 
Lindeberg 表明, 在尺度不变性的一些相当普遍的假设下, 
高斯核及其导数是用于尺度空间分析的唯一可能的平滑核. 
为了实现旋转不变性和高效率, 
我们选择了在比例空间中应用的高斯函数差 (DoG) 的最大值和最小值处选择关键位置. 
通过建立一个图像金字塔并在每个级别之间进行重采样, 可以非常有效地进行计算. 
此外, 它将关键点定位在变化较大的区域和尺度上, 从而使这些位置对于表征图像特别稳定. 
Crowley＆Parker 和 Lindeberg 以前曾将尺度空间中的高斯差 (difference-of-Gaussian DoG) 用于其他目的. 
在下文中, 我们描述了一种特别有效且稳定的方法来检测和表征该函数的最大值和最小值. 

由于 2D 高斯函数是可分离的, 因此可以通过在水平和垂直方向上应用 1D 高斯函数
的两次通过来有效地计算其与输入图像的卷积:   


![gaussian_kernel](http://chart.googleapis.com/chart?cht=tx&chl=\Large%20g(x)%20=%20\frac{1}{\sqrt{2\pi}\sigma}%20e^{-x^{2}/2\sigma^{2}})


对于关键字定位, 所有平滑操作都使用 σ=√2 进行, 
可以使用具有 7 个采样点的 1D 内核 (形状为 (1, 7) 的卷积核) 以足够的精度对其进行近似. 

首先使用 σ=√2 的高斯函数对输入图像进行卷积得到图像 A. 
接着以用 σ=√2 的高斯函数在图像 A 的基础上进行增量平滑, 得到图像 B. 等效于 σ=2. 
difference of Gaussian 函数 (DoG) 的结果可以通过用图像 A 减于图像 B 得到. 
两个高斯图像的比率为 2/√2=√2. 

为了生成下一个金字塔等级, 
我们使用双线性插值对已经平滑的图像 B 进行重新采样, 每个方向上的像素间距为 1.5. 
虽然看起来使用 √2 的尺度进行重采样会更加自然, 
但唯一的约束是采样的频率足够, 以检测峰值, 所以差一点, 无所谓. 
1.5 间距意味着每个新样本将是 4 个相邻像素的恒定线性组合. 
这对于计算和最小化因更改重采样系数而产生的混叠伪影非常有效. 

通过将金字塔中的每个像素与其相邻像素进行比较, 可以确定此比例空间函数的最大值和最小值. 
首先将一个像素与其同等级金字塔相邻的 8 个相邻像素进行比较. 
如果在此级别上是最大值或最小值, 
则考虑 1.5 倍的重采样, 在金字塔的下一个最低级别上计算最近的像素位置. 
如果像素保持高于 (或低于) 该最接近的像素及其 8 个邻居, 则对以上级别重复测试. 
由于大多数像素将在几次比较中消除, 因此这种检测的成本很小, 远低于建造金字塔的成本. 

如果金字塔的第一级以与输入图像相同的速率采样, 则最高空间频率将被忽略(没有在最清晰的图像上进行比较).
因为我们对输入图像进行了初始平滑. 因此, 在构建金字塔之前, 我们使用双线性插值将输入图像扩展 2 倍. 
对于一个典型的 512*512 像素的图像, 这大约可提供 1000 个关键点, 而在没有初始扩展的情况下, 只有其四分之一.  

#### 3.1 SIFT 关键点稳定性
为了表征每个关键位置的图像, 
对金字塔每个级别的平滑图像 A 进行处理, 以提取图像梯度和方向. 
在每个像素 Aij 处, 使用像素差来计算图像梯度量 Mij 和方向 Rij:   

![gaussian_kernel](http://chart.googleapis.com/chart?cht=tx&chl=\Large%20M_{ij}%20=%20\sqrt{(A_{ij}%20-%20A_{i+1,%20j})^{2}%20+%20(A_{ij}%20-%20A_{i,j+1})^{2}})

![gaussian_kernel](http://chart.googleapis.com/chart?cht=tx&chl=\Large%20R_{ij}%20=%20atan2(A_{ij}%20-%20A_{i+1,%20j},%20A_{i,%20j+1}%20-%20A_{ij}))

由于先前的平滑程度很高, 因此像素差异可高效计算并提供足够的精度. 
确定关键位置时, 将补偿有效的半像素位置偏移. 

通过将梯度幅度阈值限制为最大可能梯度值的 0.1 倍, 可以增强对照明变化的鲁棒性. 
这会减少具有 3D 浮雕的表面的照明方向更改的影响, 
因为照明更改可能会导致梯度幅度发生较大变化, 但可能对梯度方向的影响较小. 

每个关键位置都分配了规范的方向, 因此图像描述符不随旋转而变化. 
为了使其在光照或对比度变化方面尽可能稳定, 
该方向由局部图像梯度方向直方图中的峰值确定. 
使用高斯加权窗口创建方向直方图, 该窗口是当前平滑比例 σ 的 3 倍. 
这些权重乘以阈值梯度值, 并在直方图中对应于方向 Rij 的位置累加. 
直方图有 36 个 bin, 覆盖 360 度旋转范围, 并在选择峰之前进行了平滑处理. 

可以通过对自然图像进行仿射投影, 对比度和亮度变化以及添加噪声来测试所得关键点的稳定性. 
可以根据变换参数的知识在变换图像中预测在第一图像中检测到的每个关键点的位置. 
该框架用于选择上面给出的各种采样和平滑参数, 以便可以在保持变化稳定性的同时获得最大效率. 

> 下表: 对于应用于 20 个图像样本的各种图像变换, 
此表给出了在匹配位置和比例 (匹配百分比) 以及方向 (Ori%) 上匹配的关键点的百分比. 

 图像变换 | 匹配率 | 方向匹配率
 -------- | ----- | ------ 
 A.将对比度提高1.2  | 89.0 | 86.6
 B.将强度降低0.2 | 88.5 | 85.9
 C.旋转20度 | 85.4 | 81.0
 D.按 0.7 缩放 | 85.1 | 80.3
 E.拉伸 1.2 | 83.5 | 76.1
 F.拉伸 1.5 | 77.7 | 65.0
 G.添加 10% 像素噪声 | 90.3 | 88.4
 H.A,B,C,D,E,G的全部 | 78.6 | 71.8

上表展示了试验中图像转换关键点的整体稳定性. 
该表中的每个条目都是通过组合 20 个不同测试图像的结果而生成的, 
并总结了大约 15,000 个关键点的匹配项. 
表格的每一行都显示了特定的图像转换. 
第一个数字给出了在转换图像相应位置 σ 范围内具有匹配关键点的百分比, 比例为 1.5. 
第二列给出了符合这些条件以及方向在预测值20度以内的百分比. 



### 4. 局部图像描述符







